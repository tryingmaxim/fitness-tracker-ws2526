<!-- src/app/pages/sessions/sessions.html -->
<div class="sessions-page">
  <h1>Sessions planen</h1>
  <p class="sub">
    Ordne neue Trainingseinheiten einem vorhandenen Plan zu, damit sie im Uebersicht-Modul erscheinen.
  </p>

  <div class="alert error" *ngIf="errorMsg">
    {{ errorMsg }}
  </div>

  <div class="alert info" *ngIf="infoMsg">
    {{ infoMsg }}
  </div>

  <form class="form" (ngSubmit)="add()">
    <label for="planSelect">Trainingsplan</label>
    <select
      id="planSelect"
      [(ngModel)]="form.planId"
      name="planId"
      [disabled]="loadingPlans || !plans.length || creating"
      required
    >
      <option [ngValue]="null" disabled>
        {{ loadingPlans ? 'Trainingspl√§ne werden geladen...' : 'Kein Plan vorhanden' }}
      </option>
      <option *ngFor="let p of plans" [ngValue]="p.id">
        {{ p.name }}
      </option>
    </select>

    <label for="sessionName">Session-Name</label>
    <input
      id="sessionName"
      [(ngModel)]="form.name"
      name="name"
      placeholder="z. B. Push Day"
      [disabled]="creating"
      required
    />

    <label for="sessionDate">Datum</label>
    <input
      id="sessionDate"
      [(ngModel)]="form.date"
      name="date"
      type="date"
      [disabled]="creating"
      required
    />

    <button type="submit" [disabled]="creating || !plans.length">
      {{ creating ? 'Session wird angelegt...' : 'Session hinzufuegen' }}
    </button>
  </form>

  <div class="table-wrapper">
    <p class="muted" *ngIf="loadingSessions">Sessions werden geladen...</p>
    <p class="muted" *ngIf="!loadingSessions && !sessions.length">
      Noch keine Sessions geplant. Erfasse oben deine erste Session.
    </p>

    <table class="table" *ngIf="!loadingSessions && sessions.length">
      <thead>
        <tr>
          <th>Datum</th>
          <th>Session</th>
          <th>Plan</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let s of sessions; trackBy: trackBySession">
          <td>
            <span *ngIf="s.date; else noDate">
              {{ s.date | date: 'dd.MM.yyyy' }}
            </span>
            <ng-template #noDate>-</ng-template>
          </td>
          <td>{{ s.name }}</td>
          <td>{{ getPlanName(s.planId, s.planName) }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
